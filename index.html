<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Teleprompter Pro</title>

<style>
  body {
    margin: 0;
    background: black;
    color: white;
    font-family: 'Segoe UI', Roboto, Arial, sans-serif;
    overflow: hidden;
    touch-action: manipulation;
  }

  /* Contenedor principal que permite el scroll */
  #viewport {
    height: 100vh;
    overflow-y: scroll;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  /* Ocultar barra de scroll para est√©tica de teleprompter */
  #viewport::-webkit-scrollbar {
    display: none;
  }

  #text {
    padding: 60px 40px;
    padding-bottom: 80vh; 
    font-size: 38px;
    line-height: 1.5;
    max-width: 90%;
    margin: auto;
    outline: none;
    transition: font-size 0.2s, max-width 0.2s;
  }

  /* Modo Espejo */
  .mirror-mode {
    transform: scaleX(-1);
  }

  #controls {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    background: rgba(30, 30, 30, 0.9);
    padding: 12px;
    border-radius: 15px;
    z-index: 100;
    width: 90%;
    max-width: 500px;
    border: 1px solid #444;
  }

  button {
    font-size: 16px;
    padding: 10px;
    cursor: pointer;
    background: #333;
    color: white;
    border: 1px solid #555;
    border-radius: 8px;
    min-width: 44px;
  }

  button:active {
    background: #555;
  }

  .active-mic {
    background: #d32f2f !important;
    animation: pulse 1.5s infinite;
  }

  @keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.6; }
    100% { opacity: 1; }
  }
</style>
</head>

<body>

<div id="viewport">
  <div id="text" contenteditable="true" spellcheck="false">
    ¬°Bienvenido! Pega tu guion aqu√≠. <br><br>
    1. Ajusta el tama√±o con A+ y A-.<br>
    2. Usa el bot√≥n Espejo si usas un cristal f√≠sico.<br>
    3. Pulsa el Micr√≥fono para iniciar el auto-scroll.
  </div>
</div>

<div id="controls">
  <button id="micBtn" title="Iniciar Voz y Scroll">üéôÔ∏è</button>
  <button id="mirrorBtn" title="Modo Espejo">ü™û</button>
  <button id="plusBtn">A+</button>
  <button id="minusBtn">A-</button>
  <button id="marginPlus">‚ÜîÔ∏è+</button>
  <button id="marginMinus">‚ÜîÔ∏è-</button>
  <button id="leftBtn">‚¨ÖÔ∏è</button>
  <button id="centerBtn">‚¨ÜÔ∏è</button>
  <button id="speedUp">üöÄ</button>
  <button id="speedDown">üê¢</button>
</div>

<script>
const viewport = document.getElementById("viewport");
const text = document.getElementById("text");
const micBtn = document.getElementById("micBtn");

let listening = false;
let scrollPos = 0;
let speed = 0.8; // Velocidad base

/* MOTOR DE SCROLL */
function autoScroll() {
  if (listening) {
    scrollPos += speed;
    viewport.scrollTop = scrollPos;
  }
  requestAnimationFrame(autoScroll);
}
autoScroll();

/* CONTROL DE VOZ */
const SR = window.SpeechRecognition || window.webkitSpeechRecognition;

micBtn.onclick = () => {
  if (!SR) {
    alert("Tu navegador no soporta reconocimiento de voz. El scroll funcionar√° manualmente.");
    listening = !listening;
    actualizarBotonMic();
    return;
  }

  if (!listening) {
    const recognition = new SR();
    recognition.lang = "es-ES";
    recognition.continuous = true;
    
    recognition.onstart = () => {
      listening = true;
      scrollPos = viewport.scrollTop; // Sincroniza posici√≥n actual
      actualizarBotonMic();
    };

    recognition.onend = () => {
      if (listening) recognition.start(); // Reinicio autom√°tico si se corta
    };

    recognition.start();
  } else {
    listening = false;
    actualizarBotonMic();
  }
};

function actualizarBotonMic() {
  micBtn.classList.toggle("active-mic", listening);
}

/* ESPEJO */
document.getElementById("mirrorBtn").onclick = () => {
  text.classList.toggle("mirror-mode");
};

/* TAMA√ëO Y M√ÅRGENES */
let fontSize = 38;
document.getElementById("plusBtn").onclick = () => { fontSize += 4; text.style.fontSize = fontSize + "px"; };
document.getElementById("minusBtn").onclick = () => { fontSize = Math.max(16, fontSize - 4); text.style.fontSize = fontSize + "px"; };

let marginW = 90;
document.getElementById("marginPlus").onclick = () => { marginW = Math.min(100, marginW + 5); text.style.maxWidth = marginW + "%"; };
document.getElementById("marginMinus").onclick = () => { marginW = Math.max(30, marginW - 5); text.style.maxWidth = marginW + "%"; };

/* VELOCIDAD */
document.getElementById("speedUp").onclick = () => { speed += 0.2; };
document.getElementById("speedDown").onclick = () => { speed = Math.max(0.1, speed - 0.2); };

/* ALINEACI√ìN */
document.getElementById("leftBtn").onclick = () => text.style.textAlign = "left";
document.getElementById("centerBtn").onclick = () => text.style.textAlign = "center";
</script>

</body>
</html>
